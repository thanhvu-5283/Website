
// Enhanced Product data with detailed specifications
const productData = {
    'cua-chinh': {
        title: 'S·∫¢N PH·∫®M C·ª¨A CH√çNH',
        products: [
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 1 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            }
        ]
    },
    'cua-phu': {
        title: 'S·∫¢N PH·∫®M C·ª¨A PHUÃ£',
        products: [
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 1 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            }
        ]
    },
    'cua-so': {
        title: 'S·∫¢N PH·∫®M C·ª¨A S√îÃâ',
        products: [
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 1 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            }
        ]
    },
    'cua-phong': {
        title: 'S·∫¢N PH·∫®M C·ª¨A PHOÃÄNG',
        products: [
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 2 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'C·ª≠a K√≠nh C∆∞·ªùng L·ª±c 1 C√°nh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nh√¥m OWIN + kiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'V√¢n G√¥ÃÉ TrƒÉÃÅc',
                doday: '8mm',
                phao: '2 mƒÉÃ£t',
                baohanh: '5 nƒÉm',
                tinhnang: ['Ch·ªëng tr·ªôm', 'C√°ch √¢m t·ªët', 'Ch·ªëng th·∫•m n∆∞·ªõc'],
                mota: 'ƒê∆∞ÃÄng mua, phiÃÅ money',
                loai: 'C·ª≠a Ch√≠nh',
                phukien: ['chim thanh', 'chim l√¢m', 'chim anh anh']
            }
        ]
    }
};

// Get all products for search
function getAllProducts() {
    let allProducts = [];
    for (const category in productData) {
        allProducts = allProducts.concat(productData[category].products);
    }
    return allProducts;
}

// Search functionality
function performSearch(query) {
    try {
        // Validate input
        if (!query || typeof query !== 'string' || query.trim().length === 0) {
            hideSearchResults();
            return;
        }

        // Check if productData exists
        if (!productData || typeof productData !== 'object') {
            showSearchError('D·ªØ li·ªáu s·∫£n ph·∫©m kh√¥ng kh·∫£ d·ª•ng');
            return;
        }

        const searchTerm = query.toLowerCase().trim();
        const results = [];

        // Search through all categories with error handling
        for (const category in productData) {
            try {
                if (productData[category] && Array.isArray(productData[category].products)) {
                    productData[category].products.forEach(product => {
                        // Validate product data
                        if (!product || typeof product !== 'object') return;

                        // Safe property access with fallbacks
                        const productName = (product.ten || '').toLowerCase();
                        const productMaterial = (product.material || '').toLowerCase();
                        const productCategory = (product.loai || '').toLowerCase();
                        const productDesc = (product.mota || '').toLowerCase();

                        // Check matches
                        const nameMatch = productName.includes(searchTerm);
                        const materialMatch = productMaterial.includes(searchTerm);
                        const categoryMatch = productCategory.includes(searchTerm);
                        const descMatch = productDesc.includes(searchTerm);

                        if (nameMatch || materialMatch || categoryMatch || descMatch) {
                            results.push(product);
                        }
                    });
                }
            } catch (categoryError) {
                console.warn(`L·ªói khi t√¨m ki·∫øm trong danh m·ª•c ${category}:`, categoryError);
                // Continue v·ªõi categories kh√°c
            }
        }

        displaySearchResults(results);
    } catch (error) {
        console.error('L·ªói trong qu√° tr√¨nh t√¨m ki·∫øm:', error);
        showSearchError('C√≥ l·ªói x·∫£y ra khi t√¨m ki·∫øm');
    }
}

function displaySearchResults(results) {
    try {
        const searchResultsDiv = document.getElementById('search-results');

        if (!searchResultsDiv) {
            console.error('Kh√¥ng t√¨m th·∫•y element search-results');
            return;
        }

        if (!Array.isArray(results)) {
            showSearchError('D·ªØ li·ªáu k·∫øt qu·∫£ kh√¥ng h·ª£p l·ªá');
            return;
        }

        if (results.length === 0) {
            searchResultsDiv.innerHTML = '<div class="search-result-item no-results">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o</div>';
        } else {
            searchResultsDiv.innerHTML = results.map(product => {
                // Validate product data before rendering
                if (!product || !product.id) {
                    console.warn('S·∫£n ph·∫©m thi·∫øu d·ªØ li·ªáu:', product);
                    return '';
                }

                // Safe property access with fallbacks
                const productName = escapeHtml(product.ten || 'Ch∆∞a c√≥ t√™n');
                const productPrice = product.gia ? `${formatPrice(product.gia)} VNƒê` : 'Li√™n h·ªá';
                const productCategory = escapeHtml(product.loai || 'Ch∆∞a ph√¢n lo·∫°i');
                const productId = escapeHtml(product.id);

                return `
                    <div class="search-result-item" onclick="selectSearchResult('${productId}')">
                        <div class="search-result-name">${productName}</div>
                        <div class="search-result-price">${productPrice}</div>
                        <div class="search-result-category">${productCategory}</div>
                    </div>
                `;
            }).filter(html => html !== '').join('');
        }

        searchResultsDiv.style.display = 'block';
    } catch (error) {
        console.error('L·ªói khi hi·ªÉn th·ªã k·∫øt qu·∫£ t√¨m ki·∫øm:', error);
        showSearchError('C√≥ l·ªói khi hi·ªÉn th·ªã k·∫øt qu·∫£');
    }
}

function selectSearchResult(productId) {
    try {
        if (!productId || typeof productId !== 'string') {
            console.error('Product ID kh√¥ng h·ª£p l·ªá:', productId);
            return;
        }

        // Hide search results
        hideSearchResults();

        // Clear search input
        const searchInput = document.getElementById('search-input');
        if (searchInput) {
            searchInput.value = '';
        }

        // Check if viewProductDetail function exists
        if (typeof viewProductDetail === 'function') {
            viewProductDetail(productId);
        } else {
            console.error('Function viewProductDetail kh√¥ng t·ªìn t·∫°i');
            showSearchError('Kh√¥ng th·ªÉ xem chi ti·∫øt s·∫£n ph·∫©m');
        }
    } catch (error) {
        console.error('L·ªói khi ch·ªçn s·∫£n ph·∫©m:', error);
        showSearchError('C√≥ l·ªói khi ch·ªçn s·∫£n ph·∫©m');
    }
}

// Helper functions
function hideSearchResults() {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.style.display = 'none';
        }
    } catch (error) {
        console.error('L·ªói khi ·∫©n k·∫øt qu·∫£ t√¨m ki·∫øm:', error);
    }
}

function showSearchError(message) {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.innerHTML = `<div class="search-result-item error-message">${escapeHtml(message)}</div>`;
            searchResultsDiv.style.display = 'block';
        }
    } catch (error) {
        console.error('L·ªói khi hi·ªÉn th·ªã th√¥ng b√°o l·ªói:', error);
    }
}

function escapeHtml(text) {
    if (typeof text !== 'string') return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function formatPrice(price) {
    if (typeof price === 'number') {
        return price.toLocaleString('vi-VN');
    }
    return price;
}

// Debounce function ƒë·ªÉ tr√°nh search qu√° nhi·ªÅu l·∫ßn
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// S·ª≠ d·ª•ng debounced search
const debouncedSearch = debounce(performSearch, 300);

// Event listener cho search input
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function (e) {
            debouncedSearch(e.target.value);
        });

        // Clear results when input is focused and empty
        searchInput.addEventListener('focus', function (e) {
            if (e.target.value.trim() === '') {
                hideSearchResults();
            }
        });
    }
});

function updateActiveNav(activeId) {
    // Remove active class from all nav items
    document.querySelectorAll('.nav-menu a').forEach(link => {
        link.classList.remove('active');
    });

    // Add active class to current nav item
    if (activeId) {
        document.getElementById(activeId).classList.add('active');
    }
}

function showSection(sectionName) {
    // Hide all sections
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Show selected section
    const targetSection = document.getElementById(sectionName);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // Update active navigation
    updateActiveNav('nav-' + sectionName);
}

function showProducts(category) {
    // ƒê√≥ng modal b·∫£ng gi√° n·∫øu ƒëang m·ªü
    const serviceModal = document.getElementById('serviceModal');
    if (serviceModal) {
        serviceModal.style.display = 'none'; // ·∫©n modal b·∫£ng gi√°
        document.body.style.overflow = 'auto'; // b·∫≠t l·∫°i cu·ªôn trang
    }

    // ·∫®n t·∫•t c·∫£ section
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Hi·ªán section s·∫£n ph·∫©m
    const productsSection = document.getElementById('products');
    if (productsSection) {
        productsSection.style.display = 'block';
    }

    const data = productData[category];
    if (!data) {
        console.error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu cho category:', category);
        return;
    }

    // Update ti√™u ƒë·ªÅ v√† load s·∫£n ph·∫©m
    document.getElementById('product-title').textContent = data.title;

    const productsHTML = data.products.map(product => `
        <div class="product-card">
            <div class="product-image">
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 100%; object-fit: contain; border-radius: 10px;">
            </div>
            <div class="product-info">
                <h3 class="product-title">${product.ten}</h3>
                <div class="product-price">
                    <span class="current-price">${product.gia} VNƒê</span>
                </div>
                <button class="btn" style="width: 100%;" onclick="viewProductDetail('${product.id}')">Xem chi ti·∫øt</button>
            </div>
        </div>
    `).join('');

    const productsList = document.getElementById('products-list');
    if (productsList) {
        productsList.innerHTML = productsHTML;
    } else {
        console.error('Kh√¥ng t√¨m th·∫•y element products-list');
    }

    updateActiveNav('nav-' + category);
}


function viewProductDetail(productId) {
    // Find product in all categories
    let product = null;
    for (const category in productData) {
        product = productData[category].products.find(p => p.id === productId);
        if (product) break;
    }

    if (!product) return;

    // Populate modal with product details
    document.getElementById('modal-title').textContent = 'Chi Ti·∫øt S·∫£n Ph·∫©m';
    document.getElementById('modal-product-name').textContent = product.ten;
    document.getElementById('modal-price').textContent = product.gia + ' VNƒê';
    if (product.oldPrice && product.oldPrice !== '0' && product.oldPrice !== '0 VNƒê') {
        document.getElementById('modal-old-price').textContent = product.oldPrice + ' VNƒê';
        document.getElementById('modal-old-price').style.display = 'inline';
    } else {
        document.getElementById('modal-old-price').style.display = 'none';
    }
    // Display image in modal
    document.getElementById('modal-image').innerHTML = `
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 300px; object-fit: contain; border-radius: 10px;">
            `;

    // Generate specifications
    const specsHTML = `
    <div class="spec-item">
        <span><strong>Ch·∫•t li·ªáu:</strong></span>
        <span>${product.chatlieu || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>M√†u:</strong></span>
        <span>${product.mau || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>KiÃÅch th∆∞∆°ÃÅc:</strong></span>
        <span>${product.kichthuoc || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>B·∫£n c√°nh:</strong></span>
        <span>${product.bancanh || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>ƒê·ªô d√†y:</strong></span>
        <span>${product.doday || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Ph√†o:</strong></span>
        <span>${product.phao || 'Kh√¥ng c√≥ '}</span>
    </div>
    <div class="spec-item">
        <span><strong>B·∫£o h√†nh:</strong></span>
        <span>${product.baohanh || 'Kh√¥ng c√≥ '}</span>
    </div>

            `;
    document.getElementById('modal-specs').innerHTML = specsHTML;

    // Generate description with features
    const phukienHTML = product.phukien?.length
        ? product.phukien.map(acc => `<li>${acc}</li>`).join('')
        : '<li>Kh√¥ng c√≥</li>';

    const featuresHTML = product.tinhnang?.length
        ? product.tinhnang.map(feature => `<li>${feature}</li>`).join('')
        : '<li>Kh√¥ng c√≥</li>';

    const descriptionHTML = `
    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
        <h5 style="margin-bottom: 10px;">üîß Ph·ª• Ki·ªán ƒêi K√®m</h5>
        <ul style="margin-left: 20px; margin-bottom: 15px;">${phukienHTML}</ul>
        
        <h5 style="margin-bottom: 10px;">‚ú® T√≠nh NƒÉng N·ªïi B·∫≠t</h5>
        <ul style="margin-left: 20px; margin-bottom: 15px;">${featuresHTML}</ul>

        <h4 style="margin-bottom: 10px;">üìÑ M√¥ T·∫£ S·∫£n Ph·∫©m</h4>
        <p>${product.mota || 'Kh√¥ng c√≥ m√¥ t·∫£ chi ti·∫øt.'}</p>
    </div>
`;
    document.getElementById('modal-description').innerHTML = descriptionHTML;

    // Show modal
    document.getElementById('productModal').style.display = 'block';
}

function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

// Service details data
const serviceDetails = {
    'pricing': {
        title: 'B·∫¢NG GI√Å M·ªöI NH·∫§T',
        icon: 'üí∞',
        content: `
                    <div class="service-detail">
                        <h3>üìã B·∫£ng Gi√° CHUNG</h3>
                        <div class="price-table">
                        <div class="price-item" onclick="showProducts('cua-chinh')">
                            <h4>C·ª≠a Ch√≠nh</h4>
                            <p class="price">7.000.000 - 60.000.000 VNƒê</p>
                            <p>T√πy theo k√≠ch th∆∞·ªõc v√† thi·∫øt k·∫ø</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-phu')">
                            <h4>C·ª≠a Ph·ª•</h4>
                            <p class="price">4.000.000 - 40.000.000 VNƒê</p>
                            <p>Ph√π h·ª£p cho c√°c kh√¥ng gian nh·ªè</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-so')">
                            <h4>C·ª≠a S·ªï</h4>
                            <p class="price">3.000.000 - 30.000.000 VNƒê</p>
                            <p>ƒêa d·∫°ng ki·ªÉu d√°ng v√† k√≠ch th∆∞·ªõc</p>
                        </div>
                        </div>
                        <div class="price-note">
                            <h4>üìå L∆∞u √ù Quan Tr·ªçng:</h4>
                            <ul>
                                <li>‚úì Gi√° ƒë√£ bao g·ªìm v·∫≠t li·ªáu v√† l·∫Øp ƒë·∫∑t</li>
                                <li>‚úì Mi·ªÖn ph√≠ ƒëo ƒë·∫°c v√† t∆∞ v·∫•n t·∫°i nh√†</li>
                                <li>‚úì B·∫£o h√†nh t·ª´ 3-7 nƒÉm t√πy s·∫£n ph·∫©m</li>
                                <li>‚úì Gi√° c√≥ th·ªÉ thay ƒë·ªïi theo thi·∫øt k·∫ø ƒë·∫∑c bi·ªát</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'shipping': {
        title: 'H·ªñ TR·ª¢ V·∫¨N CHUY·ªÇN',
        icon: 'üöö',
        content: `
                    <div class="service-detail">
                        <h3>üöõ Ch√≠nh S√°ch V·∫≠n Chuy·ªÉn</h3>
                        <div class="shipping-info">
                            <div class="shipping-item">
                                <h4>üè† Giao H√†ng T·∫≠n N∆°i</h4>
                                <p>Mi·ªÖn ph√≠ giao h√†ng trong b√°n k√≠nh 20km t·ª´ showroom</p>
                                <p>Ph√≠ v·∫≠n chuy·ªÉn h·ª£p l√Ω cho c√°c khu v·ª±c xa h∆°n</p>
                            </div>
                            <div class="shipping-item">
                                <h4>üì¶ ƒê√≥ng G√≥i Chuy√™n Nghi·ªáp</h4>
                                <p>S·ª≠ d·ª•ng v·∫≠t li·ªáu ƒë√≥ng g√≥i chuy√™n d·ª•ng</p>
                                <p>ƒê·∫£m b·∫£o s·∫£n ph·∫©m kh√¥ng b·ªã h∆∞ h·ªèng trong qu√° tr√¨nh v·∫≠n chuy·ªÉn</p>
                            </div>
                            <div class="shipping-item">
                                <h4>‚è∞ Th·ªùi Gian Giao H√†ng</h4>
                                <p>Giao h√†ng trong v√≤ng 1-3 ng√†y l√†m vi·ªác</p>
                                <p>H·ªó tr·ª£ giao h√†ng kh·∫©n c·∫•p trong ng√†y (ph·ª• ph√≠)</p>
                            </div>
                        </div>
                        <div class="shipping-coverage">
                            <h4>üó∫Ô∏è Khu V·ª±c Ph·ª•c V·ª•:</h4>
                            <ul>
                                <li>‚úì To√†n b·ªô TP.HCM v√† c√°c qu·∫≠n l√¢n c·∫≠n</li>
                                <li>‚úì C√°c t·ªânh th√†nh mi·ªÅn Nam</li>
                                <li>‚úì H·ªó tr·ª£ v·∫≠n chuy·ªÉn to√†n qu·ªëc</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'support': {
        title: 'T∆Ø V·∫§N MI·ªÑN PH√ç 24/24',
        icon: 'üìû',
        content: `
                    <div class="service-detail">
                        <h3>üéß H·ªó Tr·ª£ Kh√°ch H√†ng</h3>
                        <div class="support-channels">
                            <div class="support-item">
                                <h4>üìû Hotline 24/7</h4>
                                <p class="contact-number">0799.040.616</p>
                                <p>ƒê·ªôi ng≈© t∆∞ v·∫•n vi√™n chuy√™n nghi·ªáp lu√¥n s·∫µn s√†ng h·ªó tr·ª£</p>
                            </div>
<div class="support-item">
    <h4>üì± Zalo H·ªó Tr·ª£</h4>
    <p>Nh·∫Øn tin nhanh qua Zalo</p>
    <p>Ph·∫£n h·ªìi trong gi·ªù h√†nh ch√≠nh</p>
    <a href="https://zalo.me/0799040616" target="_blank" style="color: #0088cc; text-decoration: underline;">Chat qua Zalo</a>
</div>
                            <div class="support-item">
                                <h4>üìß Email H·ªó Tr·ª£</h4>
                                <p class="contact-email">hoanganh23476@gmail.com</p>
                                <p>G·ª≠i y√™u c·∫ßu chi ti·∫øt, nh·∫≠n ph·∫£n h·ªìi trong 2-4 gi·ªù</p>
                            </div>
                        </div>
                        <div class="support-services">
                            <h4>üõ†Ô∏è D·ªãch V·ª• H·ªó Tr·ª£:</h4>
                            <ul>
                                <li>‚úì T∆∞ v·∫•n thi·∫øt k·∫ø mi·ªÖn ph√≠</li>
                                <li>‚úì ƒêo ƒë·∫°c t·∫°i nh√† kh√¥ng t√≠nh ph√≠</li>
                                <li>‚úì B√°o gi√° chi ti·∫øt v√† minh b·∫°ch</li>
                                <li>‚úì H·ªó tr·ª£ k·ªπ thu·∫≠t sau b√°n h√†ng</li>
                                <li>‚úì B·∫£o h√†nh v√† b·∫£o tr√¨ ƒë·ªãnh k·ª≥</li>
                            </ul>
                        </div>
                    </div>
                `
    }
};

// Function to open service detail modal
function openServiceDetail(serviceType) {
    const service = serviceDetails[serviceType];
    if (service) {
        document.getElementById('service-modal-title').innerHTML = service.icon + ' ' + service.title;
        document.getElementById('service-modal-content').innerHTML = service.content;
        document.getElementById('serviceModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
}

// Function to close service modal
function closeServiceModal() {
    document.getElementById('serviceModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function contactNow() {
    alert('C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m!\n\nVui l√≤ng li√™n h·ªá:\nüìû Hotline: 0799.040.616\nüìß Email: hoanganh23476@gmail.com\n\nCh√∫ng t√¥i s·∫Ω t∆∞ v·∫•n chi ti·∫øt v√† b√°o gi√° t·ªët nh·∫•t cho b·∫°n!');
}

// Event listeners
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-btn');
    const searchResults = document.getElementById('search-results');

    // Search input event
    searchInput.addEventListener('input', function () {
        performSearch(this.value);
    });

    // Search button click
    searchBtn.addEventListener('click', function () {
        const query = searchInput.value.trim();
        if (query) {
            performSearch(query);
        }
    });

    // Enter key search
    searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            const query = this.value.trim();
            if (query) {
                performSearch(query);
            }
        }
    });

    // Hide search results when clicking outside
    document.addEventListener('click', function (e) {
        if (!e.target.closest('.search-box')) {
            searchResults.style.display = 'none';
        }
    });

    // Close modal when clicking outside
    window.onclick = function (event) {
        const productModal = document.getElementById('productModal');
        const serviceModal = document.getElementById('serviceModal');
        if (event.target === productModal) {
            closeModal();
        }
        if (event.target === serviceModal) {
            closeServiceModal();
        }
    }
});

// Show home section by default
showSection('home');
