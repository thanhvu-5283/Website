
// Enhanced Product data with detailed specifications
const productData = {
    'cua-chinh': {
        title: 'SẢN PHẨM CỬA CHÍNH',
        products: [
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 1 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            }
        ]
    },
    'cua-phu': {
        title: 'SẢN PHẨM CỬA PHỤ',
        products: [
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 1 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            }
        ]
    },
    'cua-so': {
        title: 'SẢN PHẨM CỬA SỔ',
        products: [
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 1 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            }
        ]
    },
    'cua-phong': {
        title: 'SẢN PHẨM CỬA PHÒNG',
        products: [
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/1.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/2.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 2 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/3.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            },
            {
                id: 'cc001',
                ten: 'Cửa Kính Cường Lực 1 Cánh Premium',
                gia: '3.200.000',
                anh: 'assets/images/4.jpg',
                chatlieu: 'Nhôm OWIN + kính hộp hoa nan mạ đồng',
                kichthuoc: '2m x 2.8m',
                bancanh: '100',
                mau: 'Vân Gỗ Trắc',
                doday: '8mm',
                phao: '2 mặt',
                baohanh: '5 năm',
                tinhnang: ['Chống trộm', 'Cách âm tốt', 'Chống thấm nước'],
                mota: 'Đừng mua, phí money',
                loai: 'Cửa Chính',
                phukien: ['chim thanh', 'chim lâm', 'chim anh anh']
            }
        ]
    }
};

// Get all products for search
function getAllProducts() {
    let allProducts = [];
    for (const category in productData) {
        allProducts = allProducts.concat(productData[category].products);
    }
    return allProducts;
}

// Search functionality
function performSearch(query) {
    try {
        // Validate input
        if (!query || typeof query !== 'string' || query.trim().length === 0) {
            hideSearchResults();
            return;
        }

        // Check if productData exists
        if (!productData || typeof productData !== 'object') {
            showSearchError('Dữ liệu sản phẩm không khả dụng');
            return;
        }

        const searchTerm = query.toLowerCase().trim();
        const results = [];

        // Search through all categories with error handling
        for (const category in productData) {
            try {
                if (productData[category] && Array.isArray(productData[category].products)) {
                    productData[category].products.forEach(product => {
                        // Validate product data
                        if (!product || typeof product !== 'object') return;

                        // Safe property access with fallbacks
                        const productName = (product.ten || '').toLowerCase();
                        const productMaterial = (product.material || '').toLowerCase();
                        const productCategory = (product.loai || '').toLowerCase();
                        const productDesc = (product.mota || '').toLowerCase();

                        // Check matches
                        const nameMatch = productName.includes(searchTerm);
                        const materialMatch = productMaterial.includes(searchTerm);
                        const categoryMatch = productCategory.includes(searchTerm);
                        const descMatch = productDesc.includes(searchTerm);

                        if (nameMatch || materialMatch || categoryMatch || descMatch) {
                            results.push(product);
                        }
                    });
                }
            } catch (categoryError) {
                console.warn(`Lỗi khi tìm kiếm trong danh mục ${category}:`, categoryError);
                // Continue với categories khác
            }
        }

        displaySearchResults(results);
    } catch (error) {
        console.error('Lỗi trong quá trình tìm kiếm:', error);
        showSearchError('Có lỗi xảy ra khi tìm kiếm');
    }
}

function displaySearchResults(results) {
    try {
        const searchResultsDiv = document.getElementById('search-results');

        if (!searchResultsDiv) {
            console.error('Không tìm thấy element search-results');
            return;
        }

        if (!Array.isArray(results)) {
            showSearchError('Dữ liệu kết quả không hợp lệ');
            return;
        }

        if (results.length === 0) {
            searchResultsDiv.innerHTML = '<div class="search-result-item no-results">Không tìm thấy sản phẩm nào</div>';
        } else {
            searchResultsDiv.innerHTML = results.map(product => {
                // Validate product data before rendering
                if (!product || !product.id) {
                    console.warn('Sản phẩm thiếu dữ liệu:', product);
                    return '';
                }

                // Safe property access with fallbacks
                const productName = escapeHtml(product.ten || 'Chưa có tên');
                const productPrice = product.gia ? `${formatPrice(product.gia)} VNĐ` : 'Liên hệ';
                const productCategory = escapeHtml(product.loai || 'Chưa phân loại');
                const productId = escapeHtml(product.id);

                return `
                    <div class="search-result-item" onclick="selectSearchResult('${productId}')">
                        <div class="search-result-name">${productName}</div>
                        <div class="search-result-price">${productPrice}</div>
                        <div class="search-result-category">${productCategory}</div>
                    </div>
                `;
            }).filter(html => html !== '').join('');
        }

        searchResultsDiv.style.display = 'block';
    } catch (error) {
        console.error('Lỗi khi hiển thị kết quả tìm kiếm:', error);
        showSearchError('Có lỗi khi hiển thị kết quả');
    }
}

function selectSearchResult(productId) {
    try {
        if (!productId || typeof productId !== 'string') {
            console.error('Product ID không hợp lệ:', productId);
            return;
        }

        // Hide search results
        hideSearchResults();

        // Clear search input
        const searchInput = document.getElementById('search-input');
        if (searchInput) {
            searchInput.value = '';
        }

        // Check if viewProductDetail function exists
        if (typeof viewProductDetail === 'function') {
            viewProductDetail(productId);
        } else {
            console.error('Function viewProductDetail không tồn tại');
            showSearchError('Không thể xem chi tiết sản phẩm');
        }
    } catch (error) {
        console.error('Lỗi khi chọn sản phẩm:', error);
        showSearchError('Có lỗi khi chọn sản phẩm');
    }
}

// Helper functions
function hideSearchResults() {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.style.display = 'none';
        }
    } catch (error) {
        console.error('Lỗi khi ẩn kết quả tìm kiếm:', error);
    }
}

function showSearchError(message) {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.innerHTML = `<div class="search-result-item error-message">${escapeHtml(message)}</div>`;
            searchResultsDiv.style.display = 'block';
        }
    } catch (error) {
        console.error('Lỗi khi hiển thị thông báo lỗi:', error);
    }
}

function escapeHtml(text) {
    if (typeof text !== 'string') return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function formatPrice(price) {
    if (typeof price === 'number') {
        return price.toLocaleString('vi-VN');
    }
    return price;
}

// Debounce function để tránh search quá nhiều lần
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Sử dụng debounced search
const debouncedSearch = debounce(performSearch, 300);

// Event listener cho search input
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function (e) {
            debouncedSearch(e.target.value);
        });

        // Clear results when input is focused and empty
        searchInput.addEventListener('focus', function (e) {
            if (e.target.value.trim() === '') {
                hideSearchResults();
            }
        });
    }
});

function updateActiveNav(activeId) {
    // Remove active class from all nav items
    document.querySelectorAll('.nav-menu a').forEach(link => {
        link.classList.remove('active');
    });

    // Add active class to current nav item
    if (activeId) {
        document.getElementById(activeId).classList.add('active');
    }
}

function showSection(sectionName) {
    // Hide all sections
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Show selected section
    const targetSection = document.getElementById(sectionName);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // Update active navigation
    updateActiveNav('nav-' + sectionName);
}

function showProducts(category) {
    // Đóng modal bảng giá nếu đang mở
    const serviceModal = document.getElementById('serviceModal');
    if (serviceModal) {
        serviceModal.style.display = 'none'; // ẩn modal bảng giá
        document.body.style.overflow = 'auto'; // bật lại cuộn trang
    }

    // Ẩn tất cả section
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Hiện section sản phẩm
    const productsSection = document.getElementById('products');
    if (productsSection) {
        productsSection.style.display = 'block';
    }

    const data = productData[category];
    if (!data) {
        console.error('Không tìm thấy dữ liệu cho category:', category);
        return;
    }

    // Update tiêu đề và load sản phẩm
    document.getElementById('product-title').textContent = data.title;

    const productsHTML = data.products.map(product => `
        <div class="product-card">
            <div class="product-image">
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 100%; object-fit: contain; border-radius: 10px;">
            </div>
            <div class="product-info">
                <h3 class="product-title">${product.ten}</h3>
                <div class="product-price">
                    <span class="current-price">${product.gia} VNĐ</span>
                </div>
                <button class="btn" style="width: 100%;" onclick="viewProductDetail('${product.id}')">Xem chi tiết</button>
            </div>
        </div>
    `).join('');

    const productsList = document.getElementById('products-list');
    if (productsList) {
        productsList.innerHTML = productsHTML;
    } else {
        console.error('Không tìm thấy element products-list');
    }

    updateActiveNav('nav-' + category);
}


function viewProductDetail(productId) {
    // Find product in all categories
    let product = null;
    for (const category in productData) {
        product = productData[category].products.find(p => p.id === productId);
        if (product) break;
    }

    if (!product) return;

    // Populate modal with product details
    document.getElementById('modal-title').textContent = 'Chi Tiết Sản Phẩm';
    document.getElementById('modal-product-name').textContent = product.ten;
    document.getElementById('modal-price').textContent = product.gia + ' VNĐ';
    if (product.oldPrice && product.oldPrice !== '0' && product.oldPrice !== '0 VNĐ') {
        document.getElementById('modal-old-price').textContent = product.oldPrice + ' VNĐ';
        document.getElementById('modal-old-price').style.display = 'inline';
    } else {
        document.getElementById('modal-old-price').style.display = 'none';
    }
    // Display image in modal
    document.getElementById('modal-image').innerHTML = `
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 300px; object-fit: contain; border-radius: 10px;">
            `;

    // Generate specifications
    const specsHTML = `
    <div class="spec-item">
        <span><strong>Chất liệu:</strong></span>
        <span>${product.chatlieu || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Màu:</strong></span>
        <span>${product.mau || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Kích thước:</strong></span>
        <span>${product.kichthuoc || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Bản cánh:</strong></span>
        <span>${product.bancanh || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Độ dày:</strong></span>
        <span>${product.doday || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Phào:</strong></span>
        <span>${product.phao || 'Không có '}</span>
    </div>
    <div class="spec-item">
        <span><strong>Bảo hành:</strong></span>
        <span>${product.baohanh || 'Không có '}</span>
    </div>

            `;
    document.getElementById('modal-specs').innerHTML = specsHTML;

    // Generate description with features
    const phukienHTML = product.phukien?.length
        ? product.phukien.map(acc => `<li>${acc}</li>`).join('')
        : '<li>Không có</li>';

    const featuresHTML = product.tinhnang?.length
        ? product.tinhnang.map(feature => `<li>${feature}</li>`).join('')
        : '<li>Không có</li>';

    const descriptionHTML = `
    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
        <h5 style="margin-bottom: 10px;">🔧 Phụ Kiện Đi Kèm</h5>
        <ul style="margin-left: 20px; margin-bottom: 15px;">${phukienHTML}</ul>
        
        <h5 style="margin-bottom: 10px;">✨ Tính Năng Nổi Bật</h5>
        <ul style="margin-left: 20px; margin-bottom: 15px;">${featuresHTML}</ul>

        <h4 style="margin-bottom: 10px;">📄 Mô Tả Sản Phẩm</h4>
        <p>${product.mota || 'Không có mô tả chi tiết.'}</p>
    </div>
`;
    document.getElementById('modal-description').innerHTML = descriptionHTML;

    // Show modal
    document.getElementById('productModal').style.display = 'block';
}

function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

// Service details data
const serviceDetails = {
    'pricing': {
        title: 'BẢNG GIÁ MỚI NHẤT',
        icon: '💰',
        content: `
                    <div class="service-detail">
                        <h3>📋 Bảng Giá CHUNG</h3>
                        <div class="price-table">
                        <div class="price-item" onclick="showProducts('cua-chinh')">
                            <h4>Cửa Chính</h4>
                            <p class="price">7.000.000 - 60.000.000 VNĐ</p>
                            <p>Tùy theo kích thước và thiết kế</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-phu')">
                            <h4>Cửa Phụ</h4>
                            <p class="price">4.000.000 - 40.000.000 VNĐ</p>
                            <p>Phù hợp cho các không gian nhỏ</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-so')">
                            <h4>Cửa Sổ</h4>
                            <p class="price">3.000.000 - 30.000.000 VNĐ</p>
                            <p>Đa dạng kiểu dáng và kích thước</p>
                        </div>
                        </div>
                        <div class="price-note">
                            <h4>📌 Lưu Ý Quan Trọng:</h4>
                            <ul>
                                <li>✓ Giá đã bao gồm vật liệu và lắp đặt</li>
                                <li>✓ Miễn phí đo đạc và tư vấn tại nhà</li>
                                <li>✓ Bảo hành từ 3-7 năm tùy sản phẩm</li>
                                <li>✓ Giá có thể thay đổi theo thiết kế đặc biệt</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'shipping': {
        title: 'HỖ TRỢ VẬN CHUYỂN',
        icon: '🚚',
        content: `
                    <div class="service-detail">
                        <h3>🚛 Chính Sách Vận Chuyển</h3>
                        <div class="shipping-info">
                            <div class="shipping-item">
                                <h4>🏠 Giao Hàng Tận Nơi</h4>
                                <p>Miễn phí giao hàng trong bán kính 20km từ showroom</p>
                                <p>Phí vận chuyển hợp lý cho các khu vực xa hơn</p>
                            </div>
                            <div class="shipping-item">
                                <h4>📦 Đóng Gói Chuyên Nghiệp</h4>
                                <p>Sử dụng vật liệu đóng gói chuyên dụng</p>
                                <p>Đảm bảo sản phẩm không bị hư hỏng trong quá trình vận chuyển</p>
                            </div>
                            <div class="shipping-item">
                                <h4>⏰ Thời Gian Giao Hàng</h4>
                                <p>Giao hàng trong vòng 1-3 ngày làm việc</p>
                                <p>Hỗ trợ giao hàng khẩn cấp trong ngày (phụ phí)</p>
                            </div>
                        </div>
                        <div class="shipping-coverage">
                            <h4>🗺️ Khu Vực Phục Vụ:</h4>
                            <ul>
                                <li>✓ Toàn bộ TP.HCM và các quận lân cận</li>
                                <li>✓ Các tỉnh thành miền Nam</li>
                                <li>✓ Hỗ trợ vận chuyển toàn quốc</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'support': {
        title: 'TƯ VẤN MIỄN PHÍ 24/24',
        icon: '📞',
        content: `
                    <div class="service-detail">
                        <h3>🎧 Hỗ Trợ Khách Hàng</h3>
                        <div class="support-channels">
                            <div class="support-item">
                                <h4>📞 Hotline 24/7</h4>
                                <p class="contact-number">0799.040.616</p>
                                <p>Đội ngũ tư vấn viên chuyên nghiệp luôn sẵn sàng hỗ trợ</p>
                            </div>
<div class="support-item">
    <h4>📱 Zalo Hỗ Trợ</h4>
    <p>Nhắn tin nhanh qua Zalo</p>
    <p>Phản hồi trong giờ hành chính</p>
    <a href="https://zalo.me/0799040616" target="_blank" style="color: #0088cc; text-decoration: underline;">Chat qua Zalo</a>
</div>
                            <div class="support-item">
                                <h4>📧 Email Hỗ Trợ</h4>
                                <p class="contact-email">hoanganh23476@gmail.com</p>
                                <p>Gửi yêu cầu chi tiết, nhận phản hồi trong 2-4 giờ</p>
                            </div>
                        </div>
                        <div class="support-services">
                            <h4>🛠️ Dịch Vụ Hỗ Trợ:</h4>
                            <ul>
                                <li>✓ Tư vấn thiết kế miễn phí</li>
                                <li>✓ Đo đạc tại nhà không tính phí</li>
                                <li>✓ Báo giá chi tiết và minh bạch</li>
                                <li>✓ Hỗ trợ kỹ thuật sau bán hàng</li>
                                <li>✓ Bảo hành và bảo trì định kỳ</li>
                            </ul>
                        </div>
                    </div>
                `
    }
};

// Function to open service detail modal
function openServiceDetail(serviceType) {
    const service = serviceDetails[serviceType];
    if (service) {
        document.getElementById('service-modal-title').innerHTML = service.icon + ' ' + service.title;
        document.getElementById('service-modal-content').innerHTML = service.content;
        document.getElementById('serviceModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
}

// Function to close service modal
function closeServiceModal() {
    document.getElementById('serviceModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function contactNow() {
    alert('Cảm ơn bạn đã quan tâm!\n\nVui lòng liên hệ:\n📞 Hotline: 0799.040.616\n📧 Email: hoanganh23476@gmail.com\n\nChúng tôi sẽ tư vấn chi tiết và báo giá tốt nhất cho bạn!');
}

// Event listeners
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-btn');
    const searchResults = document.getElementById('search-results');

    // Search input event
    searchInput.addEventListener('input', function () {
        performSearch(this.value);
    });

    // Search button click
    searchBtn.addEventListener('click', function () {
        const query = searchInput.value.trim();
        if (query) {
            performSearch(query);
        }
    });

    // Enter key search
    searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            const query = this.value.trim();
            if (query) {
                performSearch(query);
            }
        }
    });

    // Hide search results when clicking outside
    document.addEventListener('click', function (e) {
        if (!e.target.closest('.search-box')) {
            searchResults.style.display = 'none';
        }
    });

    // Close modal when clicking outside
    window.onclick = function (event) {
        const productModal = document.getElementById('productModal');
        const serviceModal = document.getElementById('serviceModal');
        if (event.target === productModal) {
            closeModal();
        }
        if (event.target === serviceModal) {
            closeServiceModal();
        }
    }
});

// Show home section by default
showSection('home');
