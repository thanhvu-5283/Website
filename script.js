
// Enhanced Product data with detailed specifications
const productData = {
    'cua-chinh': {
        title: 'S·∫¢N PH·∫®M C·ª¨A CH√çNH',
        products: [
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc001',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc001.jpg',
                gia: '55.600.000',
                chatlieuphu: 'KiÃÅnh h√¥Ã£p nan hoa maÃ£ ƒë√¥ÃÄng',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.8m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: 'Bi√™Ã£t th∆∞Ã£ + mƒÉÃ£t trong',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc002',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc002.jpg',
                gia: '54.600.000',
                chatlieuphu: 'T√¢ÃÅm li√™ÃÄn nguy√™n kh√¥ÃÅi + kiÃÅnh cl 10mm',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.8m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: 'Bi√™Ã£t th∆∞Ã£ + mƒÉÃ£t trong',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc003',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc003.jpg',
                gia: '41.000.000',
                chatlieuphu: 'KiÃÅnh cl 10mm',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '3m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•', 'GoÃÅc ƒë√¥ÃÄng caÃÅ cheÃÅp'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc004',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc004.jpg',
                gia: '49.700.000',
                chatlieuphu: 'KiÃÅnh h√¥Ã£p nan hoa maÃ£ ƒë√¥ÃÄng',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.4m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: 'Bi√™Ã£t th∆∞Ã£ + mƒÉÃ£t trong',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc005',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc005.jpg',
                gia: '44.200.000',
                chatlieuphu: 'T√¢ÃÅm li√™ÃÄn nguy√™n kh√¥ÃÅi',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.7m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc006',
                ten: 'C·ª≠a ThuÃây L∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc006.jpg',
                gia: '49.200.000',
                chatlieuphu: 'T√¢ÃÅm li√™ÃÄn nguy√™n kh√¥ÃÅi',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.4m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: 'Bi√™Ã£t th∆∞Ã£ + mƒÉÃ£t trong',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc007',
                ten: 'C·ª≠a 2 C√°nh Nh√¥m OWIN h√™Ã£ khu√¥n phaÃÄo keÃÅp Premium',
                anh: 'assets/images/cc007.jpg',
                gia: '55.700.000',
                chatlieuphu: 'T√¢ÃÅm li√™ÃÄn nguy√™n kh√¥ÃÅi + kiÃÅnh cl 8mm',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '3m x 2.8m',
                khungbao: '√îm t∆∞∆°ÃÄng 23',
                bancanh: '160',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['KhoÃÅa ƒëa ƒëi√™Ãâm', 'BaÃân l√™ÃÄ bi ƒëuÃÉa x12', 'Ch·ªët c√°nh ph·ª•'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc008',
                ten: 'C·ª≠a thuÃây l∆∞Ã£c 2 C√°nh Nh√¥m OWIN Premium',
                anh: 'assets/images/cc008.jpg',
                gia: '42.200.000',
                chatlieuphu: 'KiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '2.8m x 2.8m',
                khungbao: '55 x 200',
                bancanh: '60 x 180',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: '',
                baohanh: '5 nƒÉm',
                phukien: ['B·∫£n l·ªÅ s√†n alder x2', 'Ng·ªóng tr√™n d∆∞·ªõi', 'Tay n·∫Øm KOLN x2', 'Kh√≥a ƒë·ªìng Owin', 'Ch·ªët c√°nh ph·ª•', 'G√¥c ƒë√¥ÃÄng caÃÅ cheÃÅp'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc009',
                ten: 'C·ª≠a 2 C√°nh Nh√¥m OWIN h√™Ã£ khu√¥n phaÃÄo keÃÅp Premium',
                anh: 'assets/images/cc009.jpg',
                gia: '57.900.000',
                chatlieuphu: 'KiÃÅnh h√¥Ã£p hoa nan maÃ£ ƒë√¥ÃÄng',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '3m x 2.8m',
                khungbao: '√îm t∆∞∆°ÃÄng 23',
                bancanh: '160',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: '',
                baohanh: '5 nƒÉm',
                phukien: ['khoÃÅa ƒëa ƒëi√™Ãâm', 'Ch·ªët c√°nh ph·ª•', 'Bi ƒëuÃÉa x20'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            },
            {
                loai: 'C·ª≠a Ch√≠nh',
                id: 'cc010',
                ten: 'C·ª≠a 2 C√°nh Nh√¥m OWIN h√™Ã£ khu√¥n phaÃÄo keÃÅp Premium',
                anh: 'assets/images/cc010.jpg',
                gia: '47.700.000',
                chatlieuphu: 'KiÃÅnh cl 10mm',
                mau: 'V√¢n g√¥ÃÉ trƒÉÃÅc',
                kichthuoc: '3m x 2.8m',
                khungbao: '√îm t∆∞∆°ÃÄng 23',
                bancanh: '160',
                doday: '',
                phao: '2 mƒÉÃ£t',
                phaotrongcanh: 'CoÃÅ',
                baohanh: '5 nƒÉm',
                phukien: ['khoÃÅa ƒëa ƒëi√™Ãâm', 'Ch·ªët c√°nh ph·ª•', 'Bi ƒëuÃÉa x20'],
                tinhnang: ['An toaÃÄn vaÃÄ baÃâo m√¢Ã£t', 'ChiÃ£u l∆∞Ã£c vaÃÄ ch√¥ÃÅng va ƒë√¢Ã£p', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'Th√¢ÃÉm myÃÉ sang troÃ£ng', 'CoÃÅ 4 maÃÄu nh√¥m'],
                mota: 'C·ª≠a th·ªßy l·ª±c nh√¥m OWIN l√† s·ª± k·∫øt h·ª£p ho√†n h·∫£o gi·ªØa th·∫©m m·ªπ tinh t·∫ø v√† c√¥ng nƒÉng v∆∞·ª£t tr·ªôi. V·ªõi thi·∫øt k·∫ø hi·ªán ƒë·∫°i, v·∫≠t li·ªáu ch·∫•t l∆∞·ª£ng cao v√† h·ªá ph·ª• ki·ªán ƒë·ªìng b·ªô, s·∫£n ph·∫©m mang ƒë·∫øn tr·∫£i nghi·ªám s·ª≠ d·ª•ng √™m √°i, b·ªÅn b·ªâ v√† sang tr·ªçng cho m·ªçi kh√¥ng gian s·ªëng.'
            }
        ]
    },
    'cua-phu': {
        title: 'S·∫¢N PH·∫®M C·ª¨A PHUÃ£',
        products: [

        ]
    },
    'cua-so': {
        title: 'S·∫¢N PH·∫®M C·ª¨A S√îÃâ',
        products: [

        ]
    },
    'cua-phong': {
        title: 'S·∫¢N PH·∫®M C·ª¨A PHOÃÄNG',
        products: [

        ]
    }
};

// Get all products for search
function getAllProducts() {
    let allProducts = [];
    for (const category in productData) {
        allProducts = allProducts.concat(productData[category].products);
    }
    return allProducts;
}

// Search functionality
function performSearch(query) {
    try {
        // Validate input
        if (!query || typeof query !== 'string' || query.trim().length === 0) {
            hideSearchResults();
            return;
        }

        // Check if productData exists
        if (!productData || typeof productData !== 'object') {
            showSearchError('D·ªØ li·ªáu s·∫£n ph·∫©m kh√¥ng kh·∫£ d·ª•ng');
            return;
        }

        const searchTerm = query.toLowerCase().trim();
        const results = [];

        // Search through all categories with error handling
        for (const category in productData) {
            try {
                if (productData[category] && Array.isArray(productData[category].products)) {
                    productData[category].products.forEach(product => {
                        // Validate product data
                        if (!product || typeof product !== 'object') return;

                        // Safe property access with fallbacks
                        const productName = (product.ten || '').toLowerCase();
                        const productMaterial = (product.chatlieu || '').toLowerCase();
                        const productCategory = (product.loai || '').toLowerCase();
                        const productDesc = (product.mota || '').toLowerCase();

                        // Check matches
                        const nameMatch = productName.includes(searchTerm);
                        const materialMatch = productMaterial.includes(searchTerm);
                        const categoryMatch = productCategory.includes(searchTerm);
                        const descMatch = productDesc.includes(searchTerm);

                        if (nameMatch || materialMatch || categoryMatch || descMatch) {
                            results.push(product);
                        }
                    });
                }
            } catch (categoryError) {
                console.warn(`L·ªói khi t√¨m ki·∫øm trong danh m·ª•c ${category}:`, categoryError);
                // Continue v·ªõi categories kh√°c
            }
        }

        displaySearchResults(results);
    } catch (error) {
        console.error('L·ªói trong qu√° tr√¨nh t√¨m ki·∫øm:', error);
        showSearchError('C√≥ l·ªói x·∫£y ra khi t√¨m ki·∫øm');
    }
}

function displaySearchResults(results) {
    try {
        const searchResultsDiv = document.getElementById('search-results');

        if (!searchResultsDiv) {
            console.error('Kh√¥ng t√¨m th·∫•y element search-results');
            return;
        }

        if (!Array.isArray(results)) {
            showSearchError('D·ªØ li·ªáu k·∫øt qu·∫£ kh√¥ng h·ª£p l·ªá');
            return;
        }

        if (results.length === 0) {
            searchResultsDiv.innerHTML = '<div class="search-result-item no-results">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o</div>';
        } else {
            searchResultsDiv.innerHTML = results.map(product => {
                // Validate product data before rendering
                if (!product || !product.id) {
                    console.warn('S·∫£n ph·∫©m thi·∫øu d·ªØ li·ªáu:', product);
                    return '';
                }

                // Safe property access with fallbacks
                const productName = escapeHtml(product.ten || 'Ch∆∞a c√≥ t√™n');
                const productPrice = product.gia ? `${formatPrice(product.gia)} VNƒê` : 'Li√™n h·ªá';
                const productCategory = escapeHtml(product.loai || 'Ch∆∞a ph√¢n lo·∫°i');
                const productId = escapeHtml(product.id);

                return `
                    <div class="search-result-item" onclick="selectSearchResult('${productId}')">
                        <div class="search-result-name">${productName}</div>
                        <div class="search-result-price">${productPrice}</div>
                        <div class="search-result-category">${productCategory}</div>
                    </div>
                `;
            }).filter(html => html !== '').join('');
        }

        searchResultsDiv.style.display = 'block';
    } catch (error) {
        console.error('L·ªói khi hi·ªÉn th·ªã k·∫øt qu·∫£ t√¨m ki·∫øm:', error);
        showSearchError('C√≥ l·ªói khi hi·ªÉn th·ªã k·∫øt qu·∫£');
    }
}

function selectSearchResult(productId) {
    try {
        if (!productId || typeof productId !== 'string') {
            console.error('Product ID kh√¥ng h·ª£p l·ªá:', productId);
            return;
        }

        // Hide search results
        hideSearchResults();

        // Clear search input
        const searchInput = document.getElementById('search-input');
        if (searchInput) {
            searchInput.value = '';
        }

        // Check if viewProductDetail function exists
        if (typeof viewProductDetail === 'function') {
            viewProductDetail(productId);
        } else {
            console.error('Function viewProductDetail kh√¥ng t·ªìn t·∫°i');
            showSearchError('Kh√¥ng th·ªÉ xem chi ti·∫øt s·∫£n ph·∫©m');
        }
    } catch (error) {
        console.error('L·ªói khi ch·ªçn s·∫£n ph·∫©m:', error);
        showSearchError('C√≥ l·ªói khi ch·ªçn s·∫£n ph·∫©m');
    }
}

// Helper functions
function hideSearchResults() {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.style.display = 'none';
        }
    } catch (error) {
        console.error('L·ªói khi ·∫©n k·∫øt qu·∫£ t√¨m ki·∫øm:', error);
    }
}

function showSearchError(message) {
    try {
        const searchResultsDiv = document.getElementById('search-results');
        if (searchResultsDiv) {
            searchResultsDiv.innerHTML = `<div class="search-result-item error-message">${escapeHtml(message)}</div>`;
            searchResultsDiv.style.display = 'block';
        }
    } catch (error) {
        console.error('L·ªói khi hi·ªÉn th·ªã th√¥ng b√°o l·ªói:', error);
    }
}

function escapeHtml(text) {
    if (typeof text !== 'string') return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

function formatPrice(price) {
    if (typeof price === 'number') {
        return price.toLocaleString('vi-VN');
    }
    return price;
}

// Debounce function ƒë·ªÉ tr√°nh search qu√° nhi·ªÅu l·∫ßn
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// S·ª≠ d·ª•ng debounced search
const debouncedSearch = debounce(performSearch, 300);

// Event listener cho search input
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function (e) {
            debouncedSearch(e.target.value);
        });

        // Clear results when input is focused and empty
        searchInput.addEventListener('focus', function (e) {
            if (e.target.value.trim() === '') {
                hideSearchResults();
            }
        });
    }
});

function updateActiveNav(activeId) {
    // Remove active class from all nav items
    document.querySelectorAll('.nav-menu a').forEach(link => {
        link.classList.remove('active');
    });

    // Add active class to current nav item
    if (activeId) {
        document.getElementById(activeId).classList.add('active');
    }
}

function showSection(sectionName) {
    // Hide all sections
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Show selected section
    const targetSection = document.getElementById(sectionName);
    if (targetSection) {
        targetSection.style.display = 'block';
    }

    // Update active navigation
    updateActiveNav('nav-' + sectionName);
}

function showProducts(category) {
    // ƒê√≥ng modal b·∫£ng gi√° n·∫øu ƒëang m·ªü
    const serviceModal = document.getElementById('serviceModal');
    if (serviceModal) {
        serviceModal.style.display = 'none'; // ·∫©n modal b·∫£ng gi√°
        document.body.style.overflow = 'auto'; // b·∫≠t l·∫°i cu·ªôn trang
    }

    // ·∫®n t·∫•t c·∫£ section
    const sections = document.querySelectorAll('.page-section');
    sections.forEach(section => {
        section.style.display = 'none';
    });

    // Hi·ªán section s·∫£n ph·∫©m
    const productsSection = document.getElementById('products');
    if (productsSection) {
        productsSection.style.display = 'block';
    }

    const data = productData[category];
    if (!data) {
        console.error('Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu cho category:', category);
        return;
    }

    // Update ti√™u ƒë·ªÅ v√† load s·∫£n ph·∫©m
    document.getElementById('product-title').textContent = data.title;

    const productsHTML = data.products.map(product => `
        <div class="product-card">
            <div class="product-image">
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 100%; object-fit: contain; border-radius: 10px;">
            </div>
            <div class="product-info">
                <h3 class="product-title">${product.ten}</h3>
                <div class="product-price">
                    <span class="current-price">${product.gia} VNƒê</span>
                </div>
                <button class="btn" style="width: 100%;" onclick="viewProductDetail('${product.id}')">Xem chi ti·∫øt</button>
            </div>
        </div>
    `).join('');

    const productsList = document.getElementById('products-list');
    if (productsList) {
        productsList.innerHTML = productsHTML;
    } else {
        console.error('Kh√¥ng t√¨m th·∫•y element products-list');
    }

    updateActiveNav('nav-' + category);
}


function viewProductDetail(productId) {
    // Find product in all categories
    let product = null;
    for (const category in productData) {
        product = productData[category].products.find(p => p.id === productId);
        if (product) break;
    }

    if (!product) return;

    // Populate modal with product details
    document.getElementById('modal-title').textContent = 'Chi Ti·∫øt S·∫£n Ph·∫©m';
    document.getElementById('modal-product-name').textContent = product.ten;
    document.getElementById('modal-price').textContent = product.gia + ' VNƒê';
    if (product.oldPrice && product.oldPrice !== '0' && product.oldPrice !== '0 VNƒê') {
        document.getElementById('modal-old-price').textContent = product.oldPrice + ' VNƒê';
        document.getElementById('modal-old-price').style.display = 'inline';
    } else {
        document.getElementById('modal-old-price').style.display = 'none';
    }
    // Display image in modal
    document.getElementById('modal-image').innerHTML = `
                <img src="${product.anh}" alt="${product.ten}" style="width: 100%; height: 300px; object-fit: contain; border-radius: 10px;">
            `;

    // Generate specifications
    const specsHTML = `
${product.chatlieuphu ? `
    <div class="spec-item">
        <span><strong>Ch·∫•t li·ªáu ph·ª•:</strong></span>
        <span>${product.chatlieuphu}</span>
    </div>` : ''}

${product.mau ? `
    <div class="spec-item">
        <span><strong>M√†u:</strong></span>
        <span>${product.mau}</span>
    </div>` : ''}

${product.kichthuoc ? `
    <div class="spec-item">
        <span><strong>K√≠ch th∆∞·ªõc:</strong></span>
        <span>${product.kichthuoc}</span>
    </div>` : ''}
${product.khungbao ? `
    <div class="spec-item">
        <span><strong>Khung bao:</strong></span>
        <span>${product.khungbao}</span>
    </div>` : ''}
${product.bancanh ? `
    <div class="spec-item">
        <span><strong>B·∫£n c√°nh:</strong></span>
        <span>${product.bancanh}</span>
    </div>` : ''}

${product.doday ? `
    <div class="spec-item">
        <span><strong>ƒê·ªô d√†y:</strong></span>
        <span>${product.doday}</span>
    </div>` : ''}

${product.phao ? `
    <div class="spec-item">
        <span><strong>Ph√†o:</strong></span>
        <span>${product.phao}</span>
    </div>` : ''}



${product.phaotrongcanh ? `
    <div class="spec-item">
        <span><strong>Ph√†o trong c√°nh:</strong></span>
        <span>${product.phaotrongcanh}</span>
    </div>` : ''}
${product.baohanh ? `
    <div class="spec-item">
        <span><strong>B·∫£o h√†nh:</strong></span>
        <span>${product.baohanh}</span>
    </div>` : ''}
            `;
    document.getElementById('modal-specs').innerHTML = specsHTML;

    // Generate description with features
    const phukienHTML = product.phukien?.length
        ? product.phukien.map(acc => `<li>${acc}</li>`).join('')
        : '<li>Kh√¥ng c√≥</li>';

    const featuresHTML = product.tinhnang?.length
        ? product.tinhnang.map(feature => `<li>${feature}</li>`).join('')
        : '<li>Kh√¥ng c√≥</li>';

    const descriptionHTML = `
<div style="background: #f8f9fa; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
    <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px;">
        <div style="flex: 1; min-width: 200px;">
            <h5 style="margin-bottom: 10px;">üîß Ph·ª• Ki·ªán ƒêi K√®m</h5>
            <ul style="margin-left: 20px;">${phukienHTML}</ul>
        </div>
        <div style="flex: 1; min-width: 200px;">
            <h5 style="margin-bottom: 10px;">‚ú® T√≠nh NƒÉng N·ªïi B·∫≠t</h5>
            <ul style="margin-left: 20px;">${featuresHTML}</ul>
        </div>
    </div>

    <h4 style="margin-bottom: 10px;">üìÑ M√¥ T·∫£ S·∫£n Ph·∫©m</h4>
    <p>${product.mota || 'Kh√¥ng c√≥ m√¥ t·∫£ chi ti·∫øt.'}</p>
</div>
`;
    document.getElementById('modal-description').innerHTML = descriptionHTML;

    // Show modal
    document.getElementById('productModal').style.display = 'block';
}

function closeModal() {
    document.getElementById('productModal').style.display = 'none';
}

// Service details data
const serviceDetails = {
    'pricing': {
        title: 'B·∫¢NG GI√Å M·ªöI NH·∫§T',
        icon: 'üí∞',
        content: `
                    <div class="service-detail">
                        <h3>üìã B·∫£ng Gi√° CHUNG</h3>
                        <div class="price-table">
                        <div class="price-item" onclick="showProducts('cua-chinh')">
                            <h4>C·ª≠a Ch√≠nh</h4>
                            <p class="price">7.000.000 - 60.000.000 VNƒê</p>
                            <p>T√πy theo k√≠ch th∆∞·ªõc v√† thi·∫øt k·∫ø</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-phu')">
                            <h4>C·ª≠a Ph·ª•</h4>
                            <p class="price">4.000.000 - 40.000.000 VNƒê</p>
                            <p>Ph√π h·ª£p cho c√°c kh√¥ng gian nh·ªè</p>
                        </div>

                        <div class="price-item" onclick="showProducts('cua-so')">
                            <h4>C·ª≠a S·ªï</h4>
                            <p class="price">3.000.000 - 30.000.000 VNƒê</p>
                            <p>ƒêa d·∫°ng ki·ªÉu d√°ng v√† k√≠ch th∆∞·ªõc</p>
                        </div>
                        </div>
                        <div class="price-note">
                            <h4>üìå L∆∞u √ù Quan Tr·ªçng:</h4>
                            <ul>
                                <li>‚úì Gi√° ƒë√£ bao g·ªìm v·∫≠t li·ªáu v√† l·∫Øp ƒë·∫∑t</li>
                                <li>‚úì Mi·ªÖn ph√≠ ƒëo ƒë·∫°c v√† t∆∞ v·∫•n t·∫°i nh√†</li>
                                <li>‚úì B·∫£o h√†nh t·ª´ 3-7 nƒÉm t√πy s·∫£n ph·∫©m</li>
                                <li>‚úì Gi√° c√≥ th·ªÉ thay ƒë·ªïi theo thi·∫øt k·∫ø ƒë·∫∑c bi·ªát</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'shipping': {
        title: 'V·ªä TR√ç X∆Ø·ªûNG',
        icon: 'üìç',
        content: `
                    <div class="service-detail">
                        <h3>üè≠ V·ªã Tr√≠ X∆∞·ªüng S·∫£n Xu·∫•t</h3>
                        <div class="shipping-info">
                            <div class="location-item" onclick="openGoogleMaps()">
                                <h4>üìç ƒê·ªãa Ch·ªâ X∆∞·ªüng</h4>
                                <p><strong>C∆∞Ãâa HaÃÄng Nh√¥m HoaÃÄng Anh OWIN</strong></p>
                                <p>Nh·∫•n ƒë·ªÉ xem ƒë∆∞·ªùng ƒëi tr√™n Google Maps</p>
                            </div>
                            <div class="shipping-item">
                                <h4>üöõ Khu V·ª±c Giao H√†ng</h4>
                                <p>Mi·ªÖn ph√≠ giao h√†ng trong khu v∆∞Ã£c Ngh√™Ã£ An - HaÃÄ TiÃÉnh - QuaÃâng BiÃÄnh</p>
                                <p>Ph√≠ v·∫≠n chuy·ªÉn h·ª£p l√Ω cho c√°c khu v·ª±c xa h∆°n</p>
                            </div>
                            <div class="shipping-item">
                            <h4>üõ†Ô∏è Giao H√†ng & L·∫Øp ƒê·∫∑t</h4>
                            <p>Giao h√†ng v√† l·∫Øp ƒë·∫∑t t·∫≠n n∆°i theo l·ªãch h·∫πn v·ªõi kh√°ch h√†ng</p>
                            <p>C√≥ h·ªó tr·ª£ l·∫Øp ƒë·∫∑t kh·∫©n c·∫•p trong ng√†y (ph·ª• ph√≠)</p>
                            </div>
                        </div>
                        <div class="shipping-coverage">
                            <h4>üó∫Ô∏è Khu V·ª±c Ph·ª•c V·ª•:</h4>
                            <ul>
                                <li>‚úì To√†n b·ªô TP.HCM v√† c√°c qu·∫≠n l√¢n c·∫≠n</li>
                                <li>‚úì C√°c t·ªânh th√†nh mi·ªÅn Nam</li>
                                <li>‚úì H·ªó tr·ª£ v·∫≠n chuy·ªÉn to√†n qu·ªëc</li>
                            </ul>
                        </div>
                    </div>
                `
    },
    'support': {
        title: 'T∆Ø V·∫§N MI·ªÑN PH√ç 24/24',
        icon: 'üìû',
        content: `
                    <div class="service-detail">
                        <h3>üéß H·ªó Tr·ª£ Kh√°ch H√†ng</h3>
                        <div class="support-channels">
                            <div class="support-item" onclick="makePhoneCall('0799040616')">
                                <h4>üìû Hotline 24/7</h4>
                                <p class="contact-number">0799.040.616</p>
                                <p>Nh·∫•n ƒë·ªÉ g·ªçi ngay - ƒê·ªôi ng≈© t∆∞ v·∫•n vi√™n chuy√™n nghi·ªáp lu√¥n s·∫µn s√†ng h·ªó tr·ª£</p>
                            </div>
                            <div class="support-item" onclick="openZalo('0799040616')">
                                <h4>üì± Zalo H·ªó Tr·ª£</h4>
                                <p class="contact-number">0799.040.616</p>
                                <p>Nh·∫•n ƒë·ªÉ chat qua Zalo - Ph·∫£n h·ªìi trong gi·ªù h√†nh ch√≠nh</p>
                            </div>
                            <div class="support-item" onclick="sendEmail('hoanganh23476@gmail.com')">
                                <h4>üìß Email H·ªó Tr·ª£</h4>
                                <p class="contact-email">hoanganh23476@gmail.com</p>
                                <p>Nh·∫•n ƒë·ªÉ g·ª≠i email - Nh·∫≠n ph·∫£n h·ªìi trong 2-4 gi·ªù</p>
                            </div>
                        </div>
                        <div class="support-services">
                            <h4>üõ†Ô∏è D·ªãch V·ª• H·ªó Tr·ª£:</h4>
                            <ul>
                                <li>‚úì T∆∞ v·∫•n thi·∫øt k·∫ø mi·ªÖn ph√≠</li>
                                <li>‚úì ƒêo ƒë·∫°c t·∫°i nh√† kh√¥ng t√≠nh ph√≠</li>
                                <li>‚úì B√°o gi√° chi ti·∫øt v√† minh b·∫°ch</li>
                                <li>‚úì H·ªó tr·ª£ k·ªπ thu·∫≠t sau b√°n h√†ng</li>
                                <li>‚úì B·∫£o h√†nh v√† b·∫£o tr√¨ ƒë·ªãnh k·ª≥</li>
                            </ul>
                        </div>
                    </div>
                `
    }
};

// H√†m x·ª≠ l√Ω c√°c t∆∞∆°ng t√°c
function makePhoneCall(phoneNumber) {
    window.location.href = `tel:${phoneNumber}`;
}

function openZalo(phoneNumber) {
    // M·ªü Zalo v·ªõi s·ªë ƒëi·ªán tho·∫°i
    const zaloUrl = `https://zalo.me/${phoneNumber}`;
    window.open(zaloUrl, '_blank');
}

function sendEmail(email) {
    window.location.href = `mailto:${email}?subject=Y√™u c·∫ßu t∆∞ v·∫•n c·ª≠a nh√¥m&body=Xin ch√†o, t√¥i mu·ªën ƒë∆∞·ª£c t∆∞ v·∫•n v·ªÅ s·∫£n ph·∫©m c·ª≠a nh√¥m.`;
}

function openGoogleMaps() {
    // Thay th·∫ø t·ªça ƒë·ªô n√†y b·∫±ng t·ªça ƒë·ªô th·ª±c t·∫ø c·ªßa x∆∞·ªüng
    const latitude = 10.8231; // T·ªça ƒë·ªô m·∫´u cho TP.HCM
    const longitude = 106.6297;
    const address = "Ch∆°Ã£ C√¢ÃÄu, Ti√™n ƒêi√™ÃÄn, Nghi Xu√¢n, HaÃÄ TiÃÉnh";

    // M·ªü Google Maps v·ªõi ƒë·ªãa ch·ªâ
    const mapsUrl = `https://www.google.com/maps/place/Ch·ª£+C·∫ßu/@18.6592211,105.782445,19.7z/data=!4m6!3m5!1s0x313833c73cbed1c7:0xe1222f1f36621da1!8m2!3d18.6591993!4d105.7830219!16s%2Fg%2F11h54fsvb_?entry=ttu&g_ep=EgoyMDI1MDcwOS4wIKXMDSoASAFQAw%3D%3D`;
    window.open(mapsUrl, '_blank');
}

// Function to open service detail modal
function openServiceDetail(serviceType) {
    const service = serviceDetails[serviceType];
    if (service) {
        document.getElementById('service-modal-title').innerHTML = service.icon + ' ' + service.title;
        document.getElementById('service-modal-content').innerHTML = service.content;
        document.getElementById('serviceModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
}

// Function to close service modal
function closeServiceModal() {
    document.getElementById('serviceModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

function contactNow() {
    alert('C·∫£m ∆°n b·∫°n ƒë√£ quan t√¢m!\n\nVui l√≤ng li√™n h·ªá:\nüìû Hotline: 0799.040.616\nüìß Email: hoanganh23476@gmail.com\n\nCh√∫ng t√¥i s·∫Ω t∆∞ v·∫•n chi ti·∫øt v√† b√°o gi√° t·ªët nh·∫•t cho b·∫°n!');
}

// Event listeners
document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('search-input');
    const searchBtn = document.getElementById('search-btn');
    const searchResults = document.getElementById('search-results');

    // Search input event
    searchInput.addEventListener('input', function () {
        performSearch(this.value);
    });

    // Search button click
    searchBtn.addEventListener('click', function () {
        const query = searchInput.value.trim();
        if (query) {
            performSearch(query);
        }
    });

    // Enter key search
    searchInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
            const query = this.value.trim();
            if (query) {
                performSearch(query);
            }
        }
    });

    // Hide search results when clicking outside
    document.addEventListener('click', function (e) {
        if (!e.target.closest('.search-box')) {
            searchResults.style.display = 'none';
        }
    });

    // Close modal when clicking outside
    window.onclick = function (event) {
        const productModal = document.getElementById('productModal');
        const serviceModal = document.getElementById('serviceModal');
        if (event.target === productModal) {
            closeModal();
        }
        if (event.target === serviceModal) {
            closeServiceModal();
        }
    }
});

// Show home section by default
showSection('home');
